



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Kratos Clothing Recognition AI">
      
      
      
        <meta name="author" content="Kratos Capstone Team">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.1">
    
    
      
        <title>Models - Kratos Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.982221ab.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="#4caf50">
      
    
    
      <script src="../assets/javascripts/modernizr.1f0bcf2b.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="green" data-md-color-accent="green">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#kratos-machine-learning-models" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Kratos Documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Kratos Documentation
            </span>
            <span class="md-header-nav__topic">
              Models
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/kratos-ai/Kratos" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    kratos-ai/Kratos
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Kratos Documentation" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Kratos Documentation
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/kratos-ai/Kratos" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    kratos-ai/Kratos
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../dependencies/" title="Dependencies" class="md-nav__link">
      Dependencies
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Models
      </label>
    
    <a href="./" title="Models" class="md-nav__link md-nav__link--active">
      Models
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#predictions" title="Predictions" class="md-nav__link">
    Predictions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#color" title="Color" class="md-nav__link">
    Color
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#categorical" title="Categorical" class="md-nav__link">
    Categorical
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attribute" title="Attribute" class="md-nav__link">
    Attribute
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-a-predictor" title="Run a predictor" class="md-nav__link">
    Run a predictor
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#predict-color" title="Predict Color" class="md-nav__link">
    Predict Color
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#predict-category-1-yu" title="Predict Category #1 - Yu" class="md-nav__link">
    Predict Category #1 - Yu
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#predict-category-2-adam" title="Predict Category #2 - Adam" class="md-nav__link">
    Predict Category #2 - Adam
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#predict-category-3-jordan" title="Predict Category #3 - Jordan" class="md-nav__link">
    Predict Category #3 - Jordan
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#predict-attribute-1" title="Predict Attribute #1" class="md-nav__link">
    Predict Attribute #1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#predict-attribute-2" title="Predict Attribute #2" class="md-nav__link">
    Predict Attribute #2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#retraining" title="Retraining" class="md-nav__link">
    Retraining
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#retrain-color" title="Retrain Color" class="md-nav__link">
    Retrain Color
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retrain-category-1" title="Retrain Category #1" class="md-nav__link">
    Retrain Category #1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retrain-category-2" title="Retrain Category #2" class="md-nav__link">
    Retrain Category #2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retrain-category-3" title="Retrain Category #3" class="md-nav__link">
    Retrain Category #3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retrain-attribute-1" title="Retrain Attribute #1" class="md-nav__link">
    Retrain Attribute #1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retrain-attribute-2" title="Retrain Attribute #2" class="md-nav__link">
    Retrain Attribute #2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../labels/" title="Label Expansion" class="md-nav__link">
      Label Expansion
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../ui/" title="UI Use" class="md-nav__link">
      UI Use
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../real_use/" title="Paths Forward" class="md-nav__link">
      Paths Forward
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../contact/" title="Contact" class="md-nav__link">
      Contact
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#predictions" title="Predictions" class="md-nav__link">
    Predictions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#color" title="Color" class="md-nav__link">
    Color
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#categorical" title="Categorical" class="md-nav__link">
    Categorical
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attribute" title="Attribute" class="md-nav__link">
    Attribute
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-a-predictor" title="Run a predictor" class="md-nav__link">
    Run a predictor
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#predict-color" title="Predict Color" class="md-nav__link">
    Predict Color
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#predict-category-1-yu" title="Predict Category #1 - Yu" class="md-nav__link">
    Predict Category #1 - Yu
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#predict-category-2-adam" title="Predict Category #2 - Adam" class="md-nav__link">
    Predict Category #2 - Adam
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#predict-category-3-jordan" title="Predict Category #3 - Jordan" class="md-nav__link">
    Predict Category #3 - Jordan
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#predict-attribute-1" title="Predict Attribute #1" class="md-nav__link">
    Predict Attribute #1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#predict-attribute-2" title="Predict Attribute #2" class="md-nav__link">
    Predict Attribute #2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#retraining" title="Retraining" class="md-nav__link">
    Retraining
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#retrain-color" title="Retrain Color" class="md-nav__link">
    Retrain Color
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retrain-category-1" title="Retrain Category #1" class="md-nav__link">
    Retrain Category #1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retrain-category-2" title="Retrain Category #2" class="md-nav__link">
    Retrain Category #2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retrain-category-3" title="Retrain Category #3" class="md-nav__link">
    Retrain Category #3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retrain-attribute-1" title="Retrain Attribute #1" class="md-nav__link">
    Retrain Attribute #1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retrain-attribute-2" title="Retrain Attribute #2" class="md-nav__link">
    Retrain Attribute #2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="kratos-machine-learning-models">Kratos Machine Learning Models</h1>
<p>Included in the Kratos packages are 6 machine learning models, 5 developed with the Tensorflow framework and 1 with the PyTorch framework. These models will make predictions on an image of an article of clothing, predictions include the color of the item, the category of clothing it falls under, and some attributes of the item.</p>
<h2 id="predictions">Predictions</h2>
<h3 id="color">Color</h3>
<p>The color prediction model was developed in the PyTorch framework to predict the color of the clothes in images.<br />
The initial training images and labels are from the DeepFashion dataset <a href="https://drive.google.com/drive/folders/0B7EVK8r0v71pVDZFQXRsMDZCX1E">In-Shop Clothes Retrieval Benchmark</a> partition. At current stage, the model is capable of predicting one result like Oatmeal-indigo, Wine-cream and Orange-navy for an image that contains a person wearing clothing of multiple colors.<br />
Data from the Deep Fashion dataset has been pre-processed into a set of five text files.</p>
<ul>
<li><a href="https://github.com/kratos-ai/Kratos/blob/master/color/allcolor.txt">allcolor.txt</a> - The list of color labels  </li>
<li><a href="https://github.com/kratos-ai/Kratos/blob/master/color/traindataset.txt">traindataset.txt</a> - The list of images from the Deep fashion dataset used for the training data  </li>
<li><a href="https://github.com/kratos-ai/Kratos/blob/master/color/testdataset.txt">testdataset.txt</a> - The list of images from the Deep Fashion dataset used for the testing data  </li>
<li><a href="https://github.com/kratos-ai/Kratos/blob/master/color/trainlabelset.txt">trainlabelset.txt</a> - The list of labels accompanying the traindataset.txt data  </li>
<li><a href="https://github.com/kratos-ai/Kratos/blob/master/color/testlabelset.txt">testlabelset.txt</a> - The list of labels accompanying the testdataset.txt data  </li>
</ul>
<p>These files are generated by the <a href="https://github.com/kratos-ai/Kratos/blob/master/color/datapipeline_update.py">datapipline_update.py</a> file from the <code>list_color_cloth.txt</code> and <code>list_eval_partition.txt</code> files contained in the <a href="https://drive.google.com/drive/folders/0B7EVK8r0v71pVDZFQXRsMDZCX1E">In-Shop Clothes Retrieval Benchmark</a> partition Anno and Eval directories, respectively.  </p>
<h3 id="categorical">Categorical</h3>
<p>The categorical prediction models were developed using Tensorflow to predict categorical information about clothing in images.</p>
<p>The initial training images and labels are from the DeepFashion dataset <a href="https://drive.google.com/drive/folders/0B7EVK8r0v71pWGplNFhjc01NbzQ">Category and Attribute Prediction Benchmark</a> partition.</p>
<h3 id="attribute">Attribute</h3>
<p>The attribute prediction models were developed with the Tensorflow framework to predict a set of attributes about clothing in an image.</p>
<p>The initial training images and labels are from the DeepFashion dataset <a href="https://drive.google.com/drive/folders/0B7EVK8r0v71pWGplNFhjc01NbzQ">Category and Attribute Prediction Benchmark</a> partition.</p>
<p>Attributes refers to descriptions of five separate types; the texture, fabric, shape, part, or style of an article of clothing. The attribute predictions may return multiple instances of an attribute type with each prediction.</p>
<p>We found in our development that the large selection of attribute options was detrimental to the machine learning. <a href="./#predict-attribute-1">Attributes model #1</a> separates each of the 5 categories into a separate machine learning task. This was able to vastly improve the capabilities of accurate predictions when compared with <a href="./#predict-attribute-2">Attributes model #2</a>.</p>
<h2 id="run-a-predictor">Run a predictor</h2>
<p>Please see the <a href="../ui/">UI page</a> for operation of the Kratos models through the UI interface.</p>
<p>To run a prediction of a single model over an image or a set of images, the following files within that model architecture will need to be modified and executed.</p>
<h3 id="predict-color">Predict Color</h3>
<p>To make a prediction using the color prediction model, execute the <code>img_test.py</code> file. Modifications to the script will need to be made for the path of the desired image <code>path</code> and the path to the weights <code>test.pth</code>.<br />
This script needs the allcolor.txt file generated by the <a href="https://github.com/kratos-ai/Kratos/blob/master/color/datapipeline_update.py">datapipline_update.py</a> script.</p>
<h3 id="predict-category-1-yu">Predict Category #1 - Yu</h3>
<p>To make a prediction using category prediction model #1, a new .py file will have to be created.</p>
<pre><code>import tensorflow as tf
from tensorflow import keras
import data_precess as dp    
import reload_model as rm
import category_model as cm

model = cm.create_model()
model.load_weights('model_weights.h5')
#&lt;file&gt; can be either a path to an image, or a text file containing multiple image paths, one per line.
predictions = rm.predict(model, &lt;file&gt;)
print(predictions)
</code></pre>
<p>The category model #1 will return the top 5 predictions for each image.</p>
<h3 id="predict-category-2-adam">Predict Category #2 - Adam</h3>
<p>To make a prediction using category prediction model #2, a new .py file will have to be created.</p>
<pre><code>from inference import predict

# &lt;file&gt; is the path to an image
predictions = predict(&lt;file&gt;)
print(predictions)
</code></pre>
<p>The category model #2 will return the top 5 predictions for the image.</p>
<h3 id="predict-category-3-jordan">Predict Category #3 - Jordan</h3>
<p>To make a prediction using category prediction model #3, execute the <code>predict_vgg19.py</code> file. Modifications to the script will need to be made for the <code>filenames</code> variable. Create a list with the paths of each image for which you wish to make a prediction.</p>
<h3 id="predict-attribute-1">Predict Attribute #1</h3>
<p>To make a prediction using attribute prediction model #1, execute the <code>Agent.py</code> file. Modifications to the script will need to be made for the <code>image_path</code> and <code>dir_models</code> variables; for the paths to the image on which to predict and the path to the model respectively.  </p>
<h3 id="predict-attribute-2">Predict Attribute #2</h3>
<p>To make a prediction using attributes prediction model #2, execute the <code>runModel.py</code> file.<br />
Pass the <code>-i &lt;image_path&gt;</code> argument to run the model over a specific image.<br />
Pass the <code>-m &lt;model_path&gt;</code> argument to load specific weights.<br />
The <code>FLAGS.test_list</code> variable can point to a text file containing image paths (one per line). If the <code>-i</code> argument is not used, predictions will be made over images found within this text file.</p>
<h2 id="retraining">Retraining</h2>
<p>To execute a retraining over the same or a new dataset, the following files will need to be modified and executed.</p>
<h3 id="retrain-color">Retrain Color</h3>
<p>The python file <a href="https://github.com/kratos-ai/Kratos/blob/master/color/capstone_test.py">capstone_test.py</a> contains the code for training the color predictor model.
To retrain the color model, the four train and test files generated by the <a href="./#color">datapipeline_update.py</a> are required.<br />
To vary the number of epochs the model will train over, edit the range over which <code>intEpoch</code> is run.
To save the model after each epoch, uncomment the final line. To change the name of the save file, change <code>./test.pth</code></p>
<h3 id="retrain-category-1">Retrain Category #1</h3>
<p>The python file <a href="https://github.com/kratos-ai/Kratos/blob/master/category1/train_test.py">train_test.py</a> contains the code for training the category predictor model #1.<br />
To retrain this model, execute the <code>train_test.py</code> python file, epochs can be modified within the <code>Info.epochs</code> variable</p>
<p>The path to the main dataset file will need to be modified, the <code>PROPERTY.path</code> variable in the <code>data_processor.py</code> file.  </p>
<p>If training with <a href="../labels/#categories">expanded labels</a>, the <code>PROPERTY.CATEGORIES</code> list in <code>data_processor.py</code> will need to be manually updated with the new category names.</p>
<h3 id="retrain-category-2">Retrain Category #2</h3>
<p>The python file <a href="https://github.com/kratos-ai/Kratos/blob/master/category2/model.py">model.py</a> contains the code necessary to train the model.<br />
You can modify the architecture of the network, or tweak other hyperparameters there. Additionally by either changing the file paths, or appending to the <code>list_eval_partition.txt</code> file you can choose which images you want to train on as well as which should be in your validation, and test sets.</p>
<p>The path to the main dataset directory ill need to be modified, the <code>FLAGS.data_dir</code> variable in <code>model.py</code>.</p>
<p>If training with <a href="../labels/#categories">expanded labels</a>, the <code>FLAGS.classes</code> list in <code>model.py</code> will need to be manually updated with the new number of categories.</p>
<h3 id="retrain-category-3">Retrain Category #3</h3>
<p>The python file <a href="https://github.com/kratos-ai/Kratos/blob/master/category3/load_and_train_vgg19.py">load_and_train_vgg19.py</a> contains the code for training the category predictor model #3.<br />
To retrain this model, execute the <code>load_and_train_vgg19.py</code>. This code is designed to run one epoch.<br />
Further epochs are to be run from the <code>continue_training_vgg19.py</code> file. This file will use the weights created by <code>load_and_train_vgg19.py</code> for continued training.</p>
<p>The path to the main dataset directory will need to be modified, the <code>MODDED.data_dir</code> variable in the <code>model_architecture_vgg19.py</code> file.</p>
<p>If training with <a href="../labels/#categories">expanded labels</a>, the <code>MODDED.classes</code> and <code>MODDED.CATEGORIES</code> list in <code>model_architecture_vgg19.py</code> will need to be manually updated with the new number of categories and new category names.</p>
<h3 id="retrain-attribute-1">Retrain Attribute #1</h3>
<p>The python file <a href="https://github.com/kratos-ai/Kratos/blob/master/attribute1/KratosAttributesTrainingModel.py">KratosAttributesTrainingModel.py</a> contains the code for training the attributes predictor model #1.<br />
To retrain this model, new pickle format data files will need to be created. To do this, execute the <code>DeepFashionDataPreprocessing.py</code> script. This expects the <code>list_attr_cloth.txt</code> &amp; <code>list_eval_partition</code> files from the Category and Attribute Prediction Benchmark directory to be in the same directory as <code>DeepFashionDataPreprocessing.py</code>. This wil create two files, <code>DataSet.pickle</code> &amp; <code>Attributes.pickle</code>.<br />
Once the <code>.pickle</code> files have been created, <code>KratosAttributesTraininModel.py</code> can be run. This model has split the 5 sub-categories of attributes into separate learning tasks and will run for each of them sequentially.</p>
<h3 id="retrain-attribute-2">Retrain Attribute #2</h3>
<p>The python file <a href="https://github.com/kratos-ai/Kratos/blob/master/attribute2/attributes.py">attributes.py</a> contains the code for training the attributes predictor #2.<br />
To retrain this model, execute the <code>attributes.py</code> file.</p>
<p>The path to the main dataset directory will need to be modified, the <code>FLAGS.data_dir</code> variable in the <code>model_setup.py</code> file.</p>
<p>If training with <a href="../labels/#attributes">expanded labels</a>, the <code>FLAGS.classes</code> variable in <code>model_setup.py</code> will need to be manually updated with the new number of attributes.  </p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../dependencies/" title="Dependencies" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Dependencies
              </span>
            </div>
          </a>
        
        
          <a href="../labels/" title="Label Expansion" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Label Expansion
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.b806dc00.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>